---
date: '2024-08-05'
title: '[WEB] CSR / SSR (React와 Next.js)'
categories: ['공부', 'WEB']
summary: 'CSR / SSR (React와 Next.js) 에 대하여 학습하고 정리한 내용입니다.'
thumbnail: './thumbnail.png'
---

이번 csr과 ssr을 공부하며 평소 가지고 있었던 의문점과 나의 잘못된 생각들을 바로 잡을 수 있었다. 이에 대해서 적어보고 정리해보겠다.

# 예전과 지금의 웹 렌더링 방식 (SPA,MPA)

예전 웹페이지는 MPA로 한번에 페이지를 웹서버로 부터 받아와 ssr렌더링 하는 방식을 사용하곤 했다.
현재를 해당 MPA에서 단점을 발견하여 SPA가 나타났는데 이에 대해서 먼저 설명해보겠다.

### SPA (Single Page Application)

하나의 HTML 파일을 기반으로 자바스크립트를 이용해 동적으로 화면의 컨텐츠를 바꾸는 방식의 웹 어플리케이션이다. 그렇기에 SPA는 기본적으로 페이지 로드가 없다. 변경된 데이터만 바꿔서 사용할 수 있는 어플리케이션이다.

### MPA (Multiple Page Application)

사용자가 페이지를 요청할 때마다, 웹 서버가 요청한 UI와 필요한 데이터를 HTML로 파싱해서 보여주는 방식의 웹 어플리케이션이다.

---

전통적인 방식을 이용한다면, SPA가 사용하는 렌더링 방식은 CSR이고, MPA가 사용하는 렌더링 방식은 SSR이다.
하지만, spa가 모두 csr이라고 할 순 없고, mpa가 모두 ssr이라고 할 순 없다.
spa가 ssr을 사용하는 경우, mpa가 csr을 사용하는 경우, spa가 csr을 사용하는 경우, mpa가 ssr을 사용하는 경우가 모두 다르다.

그럼 csr과 ssr이 무엇인가! 에 대해서도 이어서 설명해보자면

## CSR과 SSR

### CSR

csr은 client side rendering을 의미하며 사용자의 행동에 따라 필요한 부분만 다시 읽어온다. 따라서 서버 측에서 렌더링하여 전체 페이지를 다시 읽어들이는 것보다 빠른 인터렉션을 기대할 수 있다. 서버는 단지 JSON파일만 보내주고, HTML을 그리는 역할은 자바스크립트를 통해 클라이언트 측에서 수행하는 방식이다.
뷰 렌더링을 유저의 브라우저가 담당하고, 먼저 웹앱을 브라우저에게 로드한 다음 필요한 데이터만 전달받아 보여주는 CSR은 트래픽을 감소시키고, 사용자에게 더 나은 경험을 제공할 수 있도록 도와준다.

### SSR

ssr은 sever side rendering을 의미하며 요청할 때마다 새로고침이 일어나면서 페이지를 로딩할 때마다 서버로부터 리소스를 전달받아 해석하고, 화면에 렌더링하는 방식이다.
이는, 인터랙션이 많은 환경에서 비효율적이다. 렌더링을 서버쪽에서 진행하면 그만큼 서버 자원이 많이 사용되기 때문에 불필요한 트래픽이 낭비된다.

**csr 장점**

- 뛰어난 반응성=> 트래픽 감소 (반응형 디자인으로 페이지상에서 무언가를 클릭했을시 기다림 없이 즉각적인 반응이 일어난다.)
- 프론트와 백엔드의 분리 (코드가 확실하게 구분되며 프론트앤드 만으로 웹사이트를 완성할 수 있다.)

**ssr 장점**

- 관리 용이한 SEO (유저가 보는 화면 방식이 곧 웹 크롤러가 보는 방식과 같기에 더 적합하다.)
- 넘쳐나는 자료 (csr 보다는 더 오랜 역사로 다양한 자료들을 얻을 수 있다.)

**csr 단점**

- seo(ssr보다 seo 노출이 어렵다. 비동기로 렌더링 되는 페이지로 인해 크롤링 하기가 어려워진다.)
- Javascript 필수 (js가 필요하다.이에 대한 이해도 필욯다ㅏ.)

**ssr 단점**

- 느린속도 (요청이 들어올때 마다 페이지를 새로 패치해야하기 때문에 로딩시간이 발생한다.)
- front와 back의 연결성 (확연히 분리 되지 않고 서로 엮여 있어 모두의 언어가 필요하다.)

와 같이 각각의 장단점이 있는데, 여기에서 ssr에 대해서 조금 더 알아보자면

기존 MPA에서 SSR 방식은

> 1. 서버 부하
> 2. 느린 페이지 로딩 시간
> 3. 상태관리의 복잡성
> 4. client side interativity 부족

등등의 이유가 있어서 문제가 됐다고 한다. 그래서 SPA가 생겨난 것이다.
그래서 SPA가 생겨난 이후로부터는 CSR인 React를 사용해 왔는데, 최근 들어서는 CSR 방식에서의 단점을 극복하기 위해 SSR 방식을 사용하곤 한다. 하지만 과거와 같은 MPA 에서의 SSR이 아니라,

현재에는 SPA에서 ssr을 사용하는 Next.js 라는 프레임 워크가 등장하였다.
이 프레임 워크는 전통적인 MPA에서의 문제점을 해결하면서도 SPA의 장점을 유지한다.

> 1. 초기 로딩 후 클라이언트 측 내비게이션
> 2. 상태 관리의 일관성
> 3. seo와 초기 로딩 속도
> 4. code spliting 및 최적화
> 5. 개발 생산성

등등의 특징을 가지고 있다.
이는 csr의 장점을 결합하여

> 1. 초기 로드 시 HTML 을 서버에서 렌더링 하지만, 그 이후의 페이지 전환은 클라이언트 측에서 이루어지는 과정을 추가
> 2. 라이브러리를 활용하여 상태를 쉽게 관리 할 수 있도록 SPA에서 ssr 구현
> 3. 페이지 단위로 코드 스플리팅을 지원하여 js만 로드.
> 4. 서버에서 HTML 렌더링 하도록 하여 SEO 유리하게 함

와 같은 SPA에서 SSR을 작동하도록 했다.

그럼, 위와 같은 csr과 ssr을 살펴보면서 또 다시 든 생각은 둘의 렌더링 과정은 어떻게 다르기에 속도 차이나 성능적인 부분에서 차이가 나는 것일까? 이다. 중간중간 언급된 HTML 로드에 관한 이야기 인데,
이에 대해서 조금 만 더 알아보자면,

## csr과 ssr의 렌더링 과정

![](https://velog.velcdn.com/images/hoeun0723/post/3ee20fa7-f870-44e9-bf9a-72d9797db720/image.png)

**CSR (Client-Side Rendering)**

1. Request HTML: 브라우저가 서버에 HTML 요청을 보냅니다.
2. Server responds with HTML: 서버는 기본 HTML 파일을 응답합니다.
3. HTML and JS Loaded: 브라우저가 HTML과 자바스크립트를 로드합니다.
4. Browser parses HTML and JS: 브라우저가 HTML과 자바스크립트를 해석합니다.
5. Render complete page: 브라우저가 완전한 페이지를 렌더링합니다.

**SSR (Server-Side Rendering)**

1. Request HTML: 브라우저가 서버에 HTML 요청을 보냅니다.
2. Server renders HTML: 서버가 요청을 받아 HTML을 렌더링합니다.
3. Server responds with rendered HTML: 서버는 렌더링된 HTML을 응답합니다.
4. HTML Loaded: 브라우저가 HTML을 로드합니다.
5. Browser parses HTML and JS: 브라우저가 HTML과 자바스크립트를 해석합니다.
6. Render complete page: 브라우저가 완전한 페이지를 렌더링합니다.

위와 같은 과정을 가진다.
그렇기 때문에 ssr이 seo가 좋았던 이유는 HTMl을 서버측에서 렌더링 해주기 때문에 클라에서 HTML을 렌더링 해서, JS 파일을 웹 크롤러들이 실행시키지 못해 HTML에서만 콘텐츠 수집하게 되고 빈 페이지로 인식하게 되는 csr과 다르기 때문이었다.

추가적으로 이미지 같은 로드에 빨랐던 이유도 모두 서버측에서 HTML 로드를 해주고 브라우저에 전달해주는 과정을 거쳤기 때문에 해당 장점이 드러났던 것이다.

## SSR에서의 서버 (내가 잘못 알고 있던 점!)

ssr의 렌더링 과정에 대해서 인식하기 전까지는 ssr에서의 서버 개념이 단순히 내가 알고 있는 api 서버 같이 뭔가 데이터 기반한 정보들을 저장하고 있는 서버라고 생각했다.

그래서 cors 에러가 날때나 api 요청을 할때 뭔가 같은 서버들끼리 통신을 하면 오류도 안 나고 api 통신이 더 쉽지 않을까? 하는 정말 아무 근거 없는 생각을 하고 살았던 것이다.

ssr에서의 서버는 단순히 HTML 파일을 Next.js 내부에 존재하는 서버에서 렌더링 시켜준다. 그러고 client에서 랜더링 하는 속도에 대해서 더 빠르고 효율성을 주고 SEO 에 좋게끔 도와준다.

렌더링 공부를 할때 "웹 서버"가 우리가 알고 있는 api 서버와는 또 다른 서버였는데, 이 웹서버와 비슷하게 데이터를 저장하는 것이 아닌, ssr 내부에서 HTML 파일을 렌더링 해주는 서버와같은것이었다.

Next.js 에서 전역적인 데이터 패칭 방식이 있긴 하지만 (getInittialProps를 사용하여) 해당 방식은 Next.js에서 추천하는 방식은 아니라고 한다! 즉 우리가 보통 흔하게 생각하고 있는 서버같은 기능을 하는 친구가 아니라는 것이다.

이렇게 실제 서버와는 다른 부분에 대해서 좋은 점을 가지곤 하는데, 이와는 다르게 서버여서 좋은 점을 가지기도 한다. 바로, 서버이기에 세션이 있어 보안적으로 더 좋은 기능을 사용할 수 있다는 점이다.

위와 같은 나의 잘못된 상식에 대해서 바로잡음과 동시에 ssr을 사용하는 이유에 대해서 더 명확하게 말할 수 있겠다 라는 생각이 들었고, ssr 방식인 Next.js를 도입하게 되는 경우에 대해서 정리하고 생각해보았다.

## 도입하기 전엔 항상 장단점을 살피자 (CSR이 좋은 경우과 SSR이 좋은 경우에 대하여!)

### React와 Next.js 중 선택할때

csr 개념과 ssr 개념에 대해서 공부하면서 그렇다면 csr 방식을 사용하는 React와 ssr 방식을 사용하는 Next.js 를 사용하는 경우는 언제일까? 를 명확하게 정리하고 싶었다.

먼저 내가 진행하고 있는 스윗이라는 프로젝트가 있는데, 해당 프로젝트의 라이브러리를 항상 고민했었다.
스윗 프로젝트는

> 1. 이미지를 렌더링해야하는 경우가 많고
> 2. 한페이지에서 주기적으로 변화하는 정보가 많지 않으며
> 3. 여러개의 페이지가 연결되어서 나타나는 경우가 있다.
> 4. typescript를 사용하고 있다.

위 3가지가 가장 큰 특징인데, 이러한 특징을 봤을때 나는

> 1. HTML 렌더링을 서버측에서 해주면서 이미지 렌더링 속도가 적은 점
> 2. 페이지 라우팅을 간편하게 할 수 있는 점
> 3. 한페이지에서 주기적으로 어떠한 정보가 변화하는것에 대한 반응을 하지 않아도 되는점
> 4. 트렌스 파일러 Babel에 typescript가 포함 되어 있다는 점
> 5. LCP FCP에 더 좋다는 점

의 성격을 가지고 있는 Next.js 를 선택하는 것이 적절하다고 생각했다.

그렇다면 위와 같은 SSR이 유리한 경우가 아니라 CSR 즉, React를 사용하는게 유리한 경우는 무엇일까 생각하던 중 "토스 증권" 페이지를 보게 됐는데
토스 증권 페이지는

> 1. 1초 단위로 변화하는 정보들이 많이 담겨 있었다.
> 2. 이미지 렌더링이 많지 않았다.
> 3. 페이지가 많지 않아 라우터가 어려운것도 아니다.
> 4. 서버로 부터 많은 데이터를 받아와야한다.

등등의 특징을 가지고 있다는 것을 발견 하게 되었다.

토스 증권 페이지는 React를 많이 사용하곤 하는데,
만약 React 가 아닌 Next.js 를 사용했다면 ssr 방식으로 페이지 전체를 거의 1초보다 더 짧은 시간에 한번씩 재 렌더링 해야했을것이다. 그럼 블링킹(blinking - 화면 깜박임) 현상이 많이 발생했을 수 있고, CSR 보다 훨씬 더 좋지 않은 랜더링 성능을 보여줬을 것이다. 페이지 전체가 바뀌는 것이 아닌 일부만 주기적으로 바뀌어 반영 되는 부분에는 CSR이 더 적절하기에, 이런 페이지는 Next.js가 아니라 React가 더 좋겠다는 생각을 했다.
또한 추가적으로 서버로 부터 많은 데이터를 받아오는 경우에서 더 많은 비용이 들 수 있기에 CSR을 사용하는게 더 좋을 것이다.

# 앞으로

csr과 ssr 개념에 공부하며 서로 렌더링 방식이 다르다는 점을 알게 되었고 왜 각각의 장점과 단점이 그런 식으로 나타나는지에 대해서도 이해할 수 있게 되었다.
프로젝트를 진행하기 전 단순히 React보다 Next.js 가 더 좋은건가? 라는 바보같은 생각을 하곤 했었는데
프로젝트 특성에 맞게 csr이 적절한 경우와 ssr이 적절한 경우를 구분하여 선택하고 개발을 진행 할 수 있게 되었다고 생각했다.

토스 ssr 사용사례 :
https://toss.tech/article/ssr-server
